---
interface Props {
  lang: 'es' | 'en';
}

const { lang } = Astro.props;

const labels = {
  es: {
    title: 'Nuestros Servicios',
    subtitle: 'Soluciones integrales de ingeniería eléctrica para proyectos industriales y comerciales.',
    viewDetails: 'Ver detalles'
  },
  en: {
    title: 'Our Services',
    subtitle: 'Comprehensive electrical engineering solutions for industrial and commercial projects.',
    viewDetails: 'View details'
  }
};

// LOCKED SERVICES LIST - DO NOT MODIFY
const services = [
  {
    id: 1,
    slug: 'instalaciones-electricas-industriales-comerciales',
    image: '/services/Instalaciones_electricas.jpeg',
    title: {
      es: 'Instalaciones eléctricas industriales y comerciales',
      en: 'Industrial and Commercial Electrical Installations'
    },
    description: {
      es: 'Ejecución de instalaciones eléctricas en oficinas, naves industriales y comercios, cumpliendo normativa vigente.',
      en: 'Execution of electrical installations in offices, industrial buildings and commercial spaces, complying with current regulations.'
    },
    hasLanding: true
  },
  {
    id: 2,
    slug: 'media-tension',
    image: '/services/media_tension.jpeg',
    title: {
      es: 'Media tensión (hasta 25 kV)',
      en: 'Medium Voltage (up to 25 kV)'
    },
    description: {
      es: 'Acometidas, transformadores, transiciones aéreo–subterráneas y gestión ante CFE hasta 25 kV.',
      en: 'Service connections, transformers, overhead-underground transitions and CFE management up to 25 kV.'
    },
    hasLanding: true
  },
  {
    id: 3,
    slug: 'baja-tension',
    image: '/services/baja_tension.jpeg',
    title: {
      es: 'Baja tensión (hasta 600 V)',
      en: 'Low Voltage (up to 600 V)'
    },
    description: {
      es: 'Distribución eléctrica, iluminación, contactos y alimentación general para proyectos comerciales y corporativos.',
      en: 'Electrical distribution, lighting, outlets and general power supply for commercial and corporate projects.'
    },
    hasLanding: false
  },
  {
    id: 4,
    slug: 'ingenieria-electrica',
    image: '/services/ingenieria-electrica.jpeg',
    title: {
      es: 'Ingeniería eléctrica',
      en: 'Electrical Engineering'
    },
    description: {
      es: 'Diseño eléctrico, diagramas unifilares, cuadros de carga y análisis técnicos.',
      en: 'Electrical design, single-line diagrams, load schedules and technical analysis.'
    },
    hasLanding: false
  },
  {
    id: 5,
    slug: 'puestas-tierra-proteccion',
    image: '/services/tierra.png',
    title: {
      es: 'Puestas a tierra y protección eléctrica',
      en: 'Grounding and Electrical Protection'
    },
    description: {
      es: 'Instalación de sistemas de tierras físicas y protección contra descargas atmosféricas.',
      en: 'Installation of physical grounding systems and lightning protection.'
    },
    hasLanding: false
  },
  {
    id: 6,
    slug: 'verificacion-uvie-cumplimiento-nom',
    image: '/services/uvie.jpeg',
    title: {
      es: 'Verificación UVIE y cumplimiento NOM',
      en: 'UVIE Verification and NOM Compliance'
    },
    description: {
      es: 'Proyectos eléctricos, memorias de cálculo y verificación conforme a normativa mexicana.',
      en: 'Electrical projects, calculation reports and verification according to Mexican regulations.'
    },
    hasLanding: true
  }
];
---

<section class="pt-24 pb-16 md:pt-32 md:pb-24 bg-white border-t border-gray-200" id="servicios">
  <div class="container mx-auto px-4 md:px-6 max-w-7xl">
    <!-- Section Header - Centered -->
    <div class="mb-20 md:mb-28 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
        {labels[lang].title}
      </h2>
      <p class="text-lg text-gray-600 max-w-3xl mx-auto">
        {labels[lang].subtitle}
      </p>
    </div>

    <!-- Services List -->
    <div class="space-y-12 md:space-y-16">
      {services.map((service, index) => {
        const isOdd = index % 2 === 0;
        const isClickable = service.hasLanding;
        const WrapperTag = isClickable ? 'a' : 'div';
        
        return (
          <WrapperTag
            href={isClickable ? `/${lang}/servicios/${service.slug}` : undefined}
            class:list={[
              'block',
              isClickable && 'group cursor-pointer'
            ]}
          >
            <!-- MOBILE: Image with overlay card -->
            <div class="md:hidden relative w-full h-[400px]">
              <img 
                src={service.image} 
                alt={service.title[lang]}
                class="absolute inset-0 w-full h-full object-cover"
                loading="lazy"
              />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/40 to-transparent"></div>
              <div class="absolute bottom-0 left-0 right-0 p-6">
                <div class="relative bg-white/95 backdrop-blur-sm p-6 shadow-bottom-only">
                  <h3 class="text-xl font-bold text-gray-900 mb-2 leading-tight">
                    {service.title[lang]}
                  </h3>
                  <p class="text-gray-700 text-sm leading-relaxed mb-3">
                    {service.description[lang]}
                  </p>
                  
                  {service.hasLanding && (
                    <div class="inline-flex items-center gap-2 text-blue-600 font-semibold text-sm group-hover:gap-3 transition-all">
                      {labels[lang].viewDetails}
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                      </svg>
                    </div>
                  )}
                </div>
              </div>
            </div>

            <!-- TABLET: Side by side, same size -->
            <div class:list={[
              'hidden md:flex lg:hidden w-full gap-0',
              isOdd ? 'flex-row' : 'flex-row-reverse'
            ]}>
              <!-- Image -->
              <div class="w-1/2 h-[320px] flex-shrink-0 overflow-hidden">
                <img 
                  src={service.image} 
                  alt={service.title[lang]}
                  class="w-full h-full object-cover"
                  loading="lazy"
                />
              </div>
              
              <!-- Panel (same size as image) -->
              <div class="w-1/2 flex items-center">
                <div class="relative bg-white shadow-bottom-only p-8 h-full flex flex-col justify-center">
                  <h3 class="text-2xl font-bold text-gray-900 mb-3 leading-tight">
                    {service.title[lang]}
                  </h3>
                  <p class="text-gray-600 text-base leading-relaxed mb-4">
                    {service.description[lang]}
                  </p>
                  
                  {service.hasLanding && (
                    <div class="inline-flex items-center gap-2 text-blue-600 font-semibold text-base group-hover:gap-3 transition-all">
                      {labels[lang].viewDetails}
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                      </svg>
                    </div>
                  )}
                </div>
              </div>
            </div>

            <!-- DESKTOP: Original overlapping design -->
            <div class="hidden lg:block">
              <div class="relative w-full flex justify-center min-h-[360px]">
                <div class:list={[
                  'relative w-full max-w-5xl',
                  'flex items-center',
                  isOdd ? 'justify-start' : 'justify-end'
                ]}>
                  
                  {/* ODD ROWS: Image LEFT, Panel RIGHT */}
                  {isOdd && (
                    <div class="w-full flex items-center gap-0">
                      <!-- Image on LEFT -->
                      <div class="w-[52%] h-[320px] flex-shrink-0 overflow-hidden">
                        <img 
                          src={service.image} 
                          alt={service.title[lang]}
                          class="w-full h-full object-cover"
                          loading="lazy"
                        />
                      </div>
                      
                      <!-- Panel overlapping from RIGHT -->
                      <div class="w-[52%] -ml-16 z-10">
                        <div class="relative bg-white shadow-bottom-only p-10">
                          <h3 class="text-3xl font-bold text-gray-900 mb-3 leading-tight">
                            {service.title[lang]}
                          </h3>
                          <p class="text-gray-600 text-base leading-relaxed mb-4">
                            {service.description[lang]}
                          </p>
                          
                          {service.hasLanding && (
                            <div class="inline-flex items-center gap-2 text-blue-600 font-semibold text-base group-hover:gap-3 transition-all">
                              {labels[lang].viewDetails}
                              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                              </svg>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  )}

                  {/* EVEN ROWS: Panel LEFT, Image RIGHT */}
                  {!isOdd && (
                    <div class="w-full flex items-center gap-0 flex-row-reverse">
                      <!-- Image on RIGHT -->
                      <div class="w-[52%] h-[320px] flex-shrink-0 overflow-hidden">
                        <img 
                          src={service.image} 
                          alt={service.title[lang]}
                          class="w-full h-full object-cover"
                          loading="lazy"
                        />
                      </div>
                      
                      <!-- Panel overlapping from LEFT -->
                      <div class="w-[52%] -mr-16 z-10">
                        <div class="relative bg-white shadow-bottom-only p-10">
                          <h3 class="text-3xl font-bold text-gray-900 mb-3 leading-tight">
                            {service.title[lang]}
                          </h3>
                          <p class="text-gray-600 text-base leading-relaxed mb-4">
                            {service.description[lang]}
                          </p>
                          
                          {service.hasLanding && (
                            <div class="inline-flex items-center gap-2 text-blue-600 font-semibold text-base group-hover:gap-3 transition-all">
                              {labels[lang].viewDetails}
                              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                              </svg>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  )}

                </div>
              </div>
            </div>
          </WrapperTag>
        );
      })}
    </div>
  </div>
</section>

<style>
  /* Shadow at top and bottom */
  .shadow-bottom-only::before {
    content: '';
    position: absolute;
    top: -10px;
    left: 5%;
    right: 5%;
    height: 12px;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.15), transparent);
    filter: blur(8px);
    z-index: -1;
  }
  
  .shadow-bottom-only::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 5%;
    right: 5%;
    height: 12px;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.15), transparent);
    filter: blur(8px);
    z-index: -1;
  }

  /* Focus styles for accessibility */
  a:focus-visible {
    outline: 3px solid #2563eb;
    outline-offset: 4px;
  }
</style>
